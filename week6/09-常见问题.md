---
layout: default
section: Week6
title: 09-å¸¸è§é—®é¢˜
---

# 09. å¸¸è§é—®é¢˜ â“

> "å‰äººæ ½æ ‘ï¼Œåäººä¹˜å‡‰" ~ ä¸­å›½è°šè¯­

æœ¬èŠ‚è¯¾æ€»ç»“é‡åŒ–ç³»ç»Ÿå¼€å‘ä¸­çš„**å¸¸è§é—®é¢˜**ï¼Œå¸®åŠ©ä½ é¿å‘ï¼

---

## ğŸ”„ æ»šåŠ¨é‡è®­ç»ƒçš„é¢‘ç‡é€‰æ‹©ï¼Ÿ

### é—®é¢˜

åˆ°åº•å¤šä¹…é‡è®­ç»ƒä¸€æ¬¡æœ€å¥½ï¼Ÿæ¯å¤©ï¼Ÿæ¯å‘¨ï¼Ÿæ¯æœˆï¼Ÿ

### ç­”æ¡ˆ

**æ²¡æœ‰æ ‡å‡†ç­”æ¡ˆï¼** ä½†å¯ä»¥æ ¹æ®ä»¥ä¸‹åŸåˆ™è°ƒæ•´ï¼š

```python
def choose_retrain_frequency(market_regime: str,
                             strategy_type: str,
                             ic_series: pd.Series) -> str:
    """
    é€‰æ‹©é‡è®­ç»ƒé¢‘ç‡
    
    Args:
        market_regime: å¸‚åœºç¯å¢ƒ ('stable', 'volatile', 'changing')
        strategy_type: ç­–ç•¥ç±»å‹ ('momentum', 'value', 'mean_reversion')
        ic_series: ICæ—¶é—´åºåˆ—
        
    Returns:
        æ¨èé¢‘ç‡ ('daily', 'weekly', 'monthly')
    """
    # 1. æ ¹æ®å¸‚åœºç¯å¢ƒè°ƒæ•´
    if market_regime == 'volatile':
        # å¸‚åœºæ³¢åŠ¨å¤§ï¼Œé¢‘ç¹é‡è®­ç»ƒ
        base_frequency = 'weekly'
    elif market_regime == 'changing':
        # å¸‚åœºåœ¨å˜åŒ–ï¼Œä¸­ç­‰é¢‘ç‡
        base_frequency = 'weekly'
    else:
        # å¸‚åœºç¨³å®šï¼Œè¾ƒä½é¢‘ç‡
        base_frequency = 'monthly'
    
    # 2. æ ¹æ®ç­–ç•¥ç±»å‹è°ƒæ•´
    if strategy_type == 'momentum':
        # åŠ¨é‡ç­–ç•¥ï¼Œä¸­ç­‰é¢‘ç‡
        frequency = base_frequency
    elif strategy_type == 'mean_reversion':
        # å‡å€¼å›å½’ï¼Œè¾ƒé«˜é¢‘ç‡
        if base_frequency == 'monthly':
            frequency = 'weekly'
        else:
            frequency = base_frequency
    else:
        # å…¶ä»–ç­–ç•¥
        frequency = base_frequency
    
    # 3. æ ¹æ®ICè¡¨ç°è°ƒæ•´
    if len(ic_series) >= 5:
        recent_ic = ic_series.tail(5)
        
        # ICæŒç»­ä¸‹é™ï¼Œæé«˜é¢‘ç‡
        ic_trend = np.polyfit(range(len(recent_ic)), recent_ic, 1)[0]
        if ic_trend < -0.005:
            if frequency == 'monthly':
                frequency = 'weekly'
            elif frequency == 'weekly':
                frequency = 'daily'
    
    return frequency

# ä½¿ç”¨ç¤ºä¾‹
frequency = choose_retrain_frequency(
    market_regime='volatile',
    strategy_type='momentum',
    ic_series=pd.Series([0.05, 0.04, 0.03, 0.02, 0.01])
)
print(f"æ¨èé¢‘ç‡: {frequency}")
```

### ç»éªŒæ³•åˆ™

| å¸‚åœºç¯å¢ƒ | ç­–ç•¥ç±»å‹ | æ¨èé¢‘ç‡ |
|---------|---------|---------|
| ç¨³å®š | ä»·å€¼ | æœˆåº¦ |
| ç¨³å®š | åŠ¨é‡ | æœˆåº¦ |
| æ³¢åŠ¨ | ä»·å€¼ | æœˆåº¦ |
| æ³¢åŠ¨ | åŠ¨é‡ | å‘¨åº¦ |
| å‰§çƒˆå˜åŒ– | ä»»ä½• | å‘¨åº¦/æ—¥åº¦ |

---

## âš–ï¸ é£é™©æ§åˆ¶ä¸æ”¶ç›Šçš„å¹³è¡¡ï¼Ÿ

### é—®é¢˜

é£æ§å¤ªä¸¥ï¼Œèµšä¸åˆ°é’±ï¼›é£æ§å¤ªæ¾ï¼Œå®¹æ˜“çˆ†ä»“ã€‚æ€ä¹ˆå¹³è¡¡ï¼Ÿ

### ç­”æ¡ˆ

**é£é™©æ§åˆ¶ä¸æ˜¯ä¸ºäº†ä¸äºé’±ï¼Œè€Œæ˜¯ä¸ºäº†é•¿æœŸç¨³å®šèµšé’±ï¼**

```python
def balance_risk_return(expected_return: float,
                       volatility: float,
                       max_drawdown_limit: float = 0.15) -> dict:
    """
    å¹³è¡¡é£é™©ä¸æ”¶ç›Š
    
    Args:
        expected_return: é¢„æœŸå¹´åŒ–æ”¶ç›Š
        volatility: å¹´åŒ–æ³¢åŠ¨ç‡
        max_drawdown_limit: æœ€å¤§å›æ’¤é™åˆ¶
        
    Returns:
        è°ƒæ•´åçš„å‚æ•°
    """
    # 1. è®¡ç®—å¤æ™®æ¯”ç‡
    risk_free_rate = 0.03
    sharpe_ratio = (expected_return - risk_free_rate) / volatility
    
    print(f"ğŸ“Š é£é™©æ”¶ç›Šåˆ†æ:")
    print(f"  é¢„æœŸæ”¶ç›Š: {expected_return:.2%}")
    print(f"  æ³¢åŠ¨ç‡: {volatility:.2%}")
    print(f"  å¤æ™®æ¯”ç‡: {sharpe_ratio:.2f}")
    
    # 2. é¢„ä¼°æœ€å¤§å›æ’¤ï¼ˆç»éªŒå…¬å¼ï¼‰
    estimated_max_dd = -volatility * 2.5
    
    print(f"  é¢„ä¼°æœ€å¤§å›æ’¤: {estimated_max_dd:.2%}")
    
    # 3. å¦‚æœé¢„ä¼°å›æ’¤è¶…è¿‡é™åˆ¶ï¼Œè°ƒæ•´ä»“ä½
    if abs(estimated_max_dd) > max_drawdown_limit:
        scale_factor = max_drawdown_limit / abs(estimated_max_dd)
        print(f"\nâš ï¸ é¢„ä¼°å›æ’¤è¶…è¿‡é™åˆ¶ï¼Œè°ƒæ•´ä»“ä½ç³»æ•°: {scale_factor:.2%}")
    else:
        scale_factor = 1.0
        print(f"\nâœ… é£é™©å¯æ§ï¼Œæ— éœ€è°ƒæ•´")
    
    # 4. è°ƒæ•´åçš„æŒ‡æ ‡
    adjusted_return = expected_return * scale_factor
    adjusted_volatility = volatility * scale_factor
    
    # 5. æ ¹æ®å¤æ™®æ¯”ç‡è°ƒæ•´æ­¢æŸ
    if sharpe_ratio > 2.0:
        # é«˜å¤æ™®ï¼Œå¯ä»¥æ”¾å®½æ­¢æŸ
        stop_loss = 0.15
    elif sharpe_ratio > 1.0:
        # ä¸­ç­‰å¤æ™®ï¼Œæ­£å¸¸æ­¢æŸ
        stop_loss = 0.10
    else:
        # ä½å¤æ™®ï¼Œæ”¶ç´§æ­¢æŸ
        stop_loss = 0.05
    
    print(f"\nğŸ’¡ è°ƒæ•´å»ºè®®:")
    print(f"  ä»“ä½ç³»æ•°: {scale_factor:.2%}")
    print(f"  è°ƒæ•´åæ”¶ç›Š: {adjusted_return:.2%}")
    print(f"  è°ƒæ•´åæ³¢åŠ¨: {adjusted_volatility:.2%}")
    print(f"  æ­¢æŸæ¯”ä¾‹: {stop_loss:.2%}")
    
    return {
        'position_scale': scale_factor,
        'adjusted_return': adjusted_return,
        'adjusted_volatility': adjusted_volatility,
        'stop_loss': stop_loss
    }

# ä½¿ç”¨ç¤ºä¾‹
result = balance_risk_return(
    expected_return=0.20,  # 20%å¹´åŒ–æ”¶ç›Š
    volatility=0.25,       # 25%å¹´åŒ–æ³¢åŠ¨
    max_drawdown_limit=0.15  # æœ€å¤§å›æ’¤15%
)
```

### é»„é‡‘æ³•åˆ™

```python
risk_return_balance = {
    "æ³•åˆ™1": "é«˜é£é™©é«˜æ”¶ç›Šï¼Œä½é£é™©ä½æ”¶ç›Š",
    "æ³•åˆ™2": "ä¸è¦è¿½æ±‚ä¸åˆ‡å®é™…çš„é«˜æ”¶ç›Š",
    "æ³•åˆ™3": "å¤æ™®æ¯”ç‡>1.0æ‰ç®—åŠæ ¼",
    "æ³•åˆ™4": "æœ€å¤§å›æ’¤æ§åˆ¶åœ¨15%ä»¥å†…",
    "æ³•åˆ™5": "æ´»ç€æ¯”èµšæ›´å¤šé’±é‡è¦"
}
```

---

## ğŸ”® é›†æˆç­–ç•¥å¦‚ä½•é€‰æ‹©ï¼Ÿ

### é—®é¢˜

æŠ•ç¥¨ï¼Ÿå¹³å‡ï¼ŸStackingï¼Ÿåˆ°åº•ç”¨å“ªä¸ªå¥½ï¼Ÿ

### ç­”æ¡ˆ

**æ ¹æ®é—®é¢˜ç±»å‹å’Œæ•°æ®ç‰¹ç‚¹é€‰æ‹©ï¼**

```python
def choose_ensemble_method(problem_type: str,
                          model_diversity: float,
                          data_size: int) -> str:
    """
    é€‰æ‹©é›†æˆæ–¹æ³•
    
    Args:
        problem_type: é—®é¢˜ç±»å‹ ('classification', 'regression')
        model_diversity: æ¨¡å‹å¤šæ ·æ€§ (0-1)
        data_size: æ•°æ®é‡
        
    Returns:
        æ¨èæ–¹æ³•
    """
    print(f"ğŸ¯ é›†æˆæ–¹æ³•é€‰æ‹©åˆ†æ:")
    print(f"  é—®é¢˜ç±»å‹: {problem_type}")
    print(f"  æ¨¡å‹å¤šæ ·æ€§: {model_diversity:.2f}")
    print(f"  æ•°æ®é‡: {data_size}")
    
    if problem_type == 'classification':
        # åˆ†ç±»é—®é¢˜
        if data_size < 10000:
            # å°æ•°æ®ï¼Œç”¨ç¡¬æŠ•ç¥¨
            method = 'hard_voting'
            print(f"\nâœ… æ¨èæ–¹æ³•: ç¡¬æŠ•ç¥¨")
            print(f"   åŸå› : æ•°æ®é‡å°ï¼Œç®€å•å¿«é€Ÿ")
        else:
            # å¤§æ•°æ®ï¼Œç”¨è½¯æŠ•ç¥¨
            method = 'soft_voting'
            print(f"\nâœ… æ¨èæ–¹æ³•: è½¯æŠ•ç¥¨")
            print(f"   åŸå› : æ•°æ®é‡å¤§ï¼Œèƒ½åˆ©ç”¨æ¦‚ç‡ä¿¡æ¯")
    
    else:  # regression
        # å›å½’é—®é¢˜
        if model_diversity < 0.3:
            # æ¨¡å‹ç›¸ä¼¼åº¦é«˜ï¼Œç”¨ç®€å•å¹³å‡
            method = 'simple_average'
            print(f"\nâœ… æ¨èæ–¹æ³•: ç®€å•å¹³å‡")
            print(f"   åŸå› : æ¨¡å‹å¤šæ ·æ€§ä½ï¼Œç®€å•å¹³å‡å³å¯")
        elif data_size > 100000:
            # å¤§æ•°æ®ï¼Œç”¨åŠ æƒå¹³å‡
            method = 'weighted_average'
            print(f"\nâœ… æ¨èæ–¹æ³•: åŠ æƒå¹³å‡")
            print(f"   åŸå› : æ•°æ®é‡å¤§ï¼Œå¯ä»¥è®¡ç®—æƒé‡")
        else:
            # å°æ•°æ®ï¼Œç”¨Stacking
            method = 'stacking'
            print(f"\nâœ… æ¨èæ–¹æ³•: Stacking")
            print(f"   åŸå› : æ•°æ®é‡é€‚ä¸­ï¼Œå¯ä»¥å­¦ä¹ æœ€ä¼˜ç»„åˆ")
    
    return method

# ä½¿ç”¨ç¤ºä¾‹
method = choose_ensemble_method(
    problem_type='regression',
    model_diversity=0.7,
    data_size=50000
)
print(f"\né€‰æ‹©: {method}")
```

### æ–¹æ³•å¯¹æ¯”

| æ–¹æ³• | é€‚ç”¨åœºæ™¯ | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|---------|------|------|
| ç¡¬æŠ•ç¥¨ | åˆ†ç±»ï¼ˆå°æ•°æ®ï¼‰ | ç®€å•å¿«é€Ÿ | å¿½ç•¥æ¦‚ç‡ |
| è½¯æŠ•ç¥¨ | åˆ†ç±»ï¼ˆå¤§æ•°æ®ï¼‰ | åˆ©ç”¨æ¦‚ç‡ | éœ€è¦æ¦‚ç‡è¾“å‡º |
| ç®€å•å¹³å‡ | å›å½’ï¼ˆä½å¤šæ ·æ€§ï¼‰ | ç®€å•ç¨³å®š | æœªè€ƒè™‘å·®å¼‚ |
| åŠ æƒå¹³å‡ | å›å½’ï¼ˆå¤§æ•°æ®ï¼‰ | åŒºåˆ†é‡è¦æ€§ | éœ€è¦è®¡ç®—æƒé‡ |
| Stacking | å¤æ‚é—®é¢˜ | å­¦ä¹ æœ€ä¼˜ | è®¡ç®—æˆæœ¬é«˜ |

---

## ğŸš« å¦‚ä½•é¿å…è¿‡æ‹Ÿåˆï¼Ÿ

### é—®é¢˜

è®­ç»ƒé›†è¡¨ç°å¾ˆå¥½ï¼Œå®ç›˜è¡¨ç°å¾ˆå·®ã€‚æ€ä¹ˆåŠï¼Ÿ

### ç­”æ¡ˆ

**è¿‡æ‹Ÿåˆæ˜¯é‡åŒ–äº¤æ˜“çš„å¤´å·æ•Œäººï¼**

```python
def avoid_overfitting(X_train, y_train, 
                      X_val, y_val,
                      X_test, y_test):
    """
    é¿å…è¿‡æ‹Ÿåˆ
    
    Args:
        X_train, y_train: è®­ç»ƒé›†
        X_val, y_val: éªŒè¯é›†
        X_test, y_test: æµ‹è¯•é›†
    """
    print("ğŸš« é˜²æ­¢è¿‡æ‹Ÿåˆç­–ç•¥:")
    
    # 1. ä½¿ç”¨æ—¶åºäº¤å‰éªŒè¯
    print("\n[1/6] æ—¶åºäº¤å‰éªŒè¯")
    from sklearn.model_selection import TimeSeriesSplit
    tscv = TimeSeriesSplit(n_splits=5)
    
    # 2. æ—©åœ
    print("\n[2/6] æ—©åœæœºåˆ¶")
    print("   å½“éªŒè¯é›†æ€§èƒ½ä¸å†æå‡æ—¶åœæ­¢è®­ç»ƒ")
    
    # 3. æ­£åˆ™åŒ–
    print("\n[3/6] æ­£åˆ™åŒ–")
    print("   L1/L2æ­£åˆ™åŒ–ã€Dropoutç­‰")
    
    # 4. ç‰¹å¾é€‰æ‹©
    print("\n[4/6] ç‰¹å¾é€‰æ‹©")
    print("   åˆ é™¤å†—ä½™ç‰¹å¾ï¼Œä¿ç•™æœ€é‡è¦çš„")
    
    # 5. æ•°æ®å¢å¼º
    print("\n[5/6] æ•°æ®å¢å¼º")
    print("   å¢åŠ è®­ç»ƒæ•°æ®çš„å¤šæ ·æ€§")
    
    # 6. ç®€åŒ–æ¨¡å‹
    print("\n[6/6] ç®€åŒ–æ¨¡å‹")
    print("   å‡å°‘æ¨¡å‹å¤æ‚åº¦")
    
    # 7. ç›‘æ§è®­ç»ƒ/éªŒè¯/æµ‹è¯•æ€§èƒ½å·®å¼‚
    print("\nğŸ’¡ æ€§èƒ½ç›‘æ§:")
    
    # è®­ç»ƒæ¨¡å‹
    model = train_model(X_train, y_train)
    
    # è®¡ç®—æ€§èƒ½
    train_perf = model.score(X_train, y_train)
    val_perf = model.score(X_val, y_val)
    test_perf = model.score(X_test, y_test)
    
    print(f"   è®­ç»ƒé›†: {train_perf:.4f}")
    print(f"   éªŒè¯é›†: {val_perf:.4f}")
    print(f"   æµ‹è¯•é›†: {test_perf:.4f}")
    
    # åˆ¤æ–­è¿‡æ‹Ÿåˆ
    if train_perf - val_perf > 0.1:
        print("\nâš ï¸ è­¦å‘Š: å¯èƒ½å­˜åœ¨è¿‡æ‹Ÿåˆï¼")
        print("   å»ºè®®æªæ–½:")
        print("   - å¢åŠ æ­£åˆ™åŒ–å¼ºåº¦")
        print("   - å‡å°‘æ¨¡å‹å¤æ‚åº¦")
        print("   - å¢åŠ è®­ç»ƒæ•°æ®")
    elif val_perf - test_perf > 0.05:
        print("\nâš ï¸ è­¦å‘Š: éªŒè¯é›†å’Œæµ‹è¯•é›†å·®å¼‚å¤§ï¼")
        print("   å¯èƒ½åŸå› : æ•°æ®åˆ†å¸ƒä¸åŒ")
    else:
        print("\nâœ… æ¨¡å‹æ³›åŒ–èƒ½åŠ›è‰¯å¥½")
```

### é˜²æ­¢è¿‡æ‹Ÿåˆåæ‹›

```python
anti_overfitting = [
    "1. æ—¶åºäº¤å‰éªŒè¯",
    "2. æ—©åœæœºåˆ¶",
    "3. æ­£åˆ™åŒ–ï¼ˆL1/L2ï¼‰",
    "4. ç‰¹å¾é€‰æ‹©",
    "5. æ•°æ®å¢å¼º",
    "6. ç®€åŒ–æ¨¡å‹",
    "7. å¢åŠ è®­ç»ƒæ•°æ®",
    "8. Dropout",
    "9. Bagging",
    "10. ç›‘æ§æ€§èƒ½å·®å¼‚"
]
```

---

## ğŸ° å¦‚ä½•ä¿è¯ç³»ç»Ÿé«˜å¯ç”¨æ€§ï¼Ÿ

### é—®é¢˜

ç³»ç»Ÿç»å¸¸å´©æºƒï¼Œç¨³å®šæ€§å·®ã€‚æ€ä¹ˆæé«˜ï¼Ÿ

### ç­”æ¡ˆ

**é«˜å¯ç”¨æ€§ = å†—ä½™ + ç›‘æ§ + å¿«é€Ÿæ¢å¤**

```python
def ensure_high_availability():
    """
    ä¿è¯é«˜å¯ç”¨æ€§
    """
    print("ğŸ° é«˜å¯ç”¨æ€§ä¿éšœ:")
    
    # 1. å†—ä½™è®¾è®¡
    print("\n[1/7] å†—ä½™è®¾è®¡")
    redundancy = {
        "æ•°æ®æº": "ä¸»æ•°æ®æº + å¤‡ä»½æ•°æ®æº",
        "æ¨¡å‹": "åœ¨çº¿æ¨¡å‹ + ç¦»çº¿æ¨¡å‹",
        "æœåŠ¡å™¨": "ä¸»æœåŠ¡å™¨ + å¤‡ç”¨æœåŠ¡å™¨",
        "å­˜å‚¨": "ä¸»æ•°æ®åº“ + ä»æ•°æ®åº“"
    }
    for component, strategy in redundancy.items():
        print(f"   {component}: {strategy}")
    
    # 2. è´Ÿè½½å‡è¡¡
    print("\n[2/7] è´Ÿè½½å‡è¡¡")
    print("   å¤šå°æœåŠ¡å™¨åˆ†æ‹…å‹åŠ›")
    
    # 3. æ•…éšœè½¬ç§»
    print("\n[3/7] æ•…éšœè½¬ç§»")
    print("   ä¸»èŠ‚ç‚¹æ•…éšœæ—¶è‡ªåŠ¨åˆ‡æ¢åˆ°å¤‡ç”¨èŠ‚ç‚¹")
    
    # 4. ç›‘æ§æŠ¥è­¦
    print("\n[4/7] ç›‘æ§æŠ¥è­¦")
    print("   å®æ—¶ç›‘æ§ï¼ŒåŠæ—¶å‘ç°é—®é¢˜")
    
    # 5. è‡ªåŠ¨æ¢å¤
    print("\n[5/7] è‡ªåŠ¨æ¢å¤")
    print("   æ•…éšœåè‡ªåŠ¨é‡å¯/æ¢å¤")
    
    # 6. å®šæœŸå¤‡ä»½
    print("\n[6/7] å®šæœŸå¤‡ä»½")
    print("   æ•°æ®ã€é…ç½®ã€æ¨¡å‹å®šæœŸå¤‡ä»½")
    
    # 7. ç¾éš¾æ¢å¤
    print("\n[7/7] ç¾éš¾æ¢å¤")
    print("   åˆ¶å®šç¾éš¾æ¢å¤è®¡åˆ’ï¼Œå®šæœŸæ¼”ç»ƒ")
```

### é«˜å¯ç”¨æ€§æ¶æ„

```python
class HighAvailabilitySystem:
    """é«˜å¯ç”¨æ€§ç³»ç»Ÿ"""
    
    def __init__(self):
        """åˆå§‹åŒ–"""
        self.primary_server = None
        self.backup_server = None
        self.health_checker = None
        self.failover_manager = None
    
    def setup(self):
        """è®¾ç½®é«˜å¯ç”¨æ€§"""
        # 1. é…ç½®ä¸»æœåŠ¡å™¨
        self.primary_server = Server(
            host='primary.example.com',
            role='primary'
        )
        
        # 2. é…ç½®å¤‡ç”¨æœåŠ¡å™¨
        self.backup_server = Server(
            host='backup.example.com',
            role='backup'
        )
        
        # 3. é…ç½®å¥åº·æ£€æŸ¥
        self.health_checker = HealthChecker(
            primary=self.primary_server,
            backup=self.backup_server,
            interval=10  # æ¯10ç§’æ£€æŸ¥ä¸€æ¬¡
        )
        
        # 4. é…ç½®æ•…éšœè½¬ç§»
        self.failover_manager = FailoverManager(
            primary=self.primary_server,
            backup=self.backup_server
        )
    
    def start(self):
        """å¯åŠ¨ç³»ç»Ÿ"""
        # å¯åŠ¨å¥åº·æ£€æŸ¥
        self.health_checker.start()
        
        # å¯åŠ¨æ•…éšœè½¬ç§»ç›‘æ§
        self.failover_manager.start()
        
        print("âœ… é«˜å¯ç”¨æ€§ç³»ç»Ÿå·²å¯åŠ¨")
```

---

## ğŸ› è°ƒè¯•æŠ€å·§

### é—®é¢˜

ç³»ç»Ÿå‡ºé—®é¢˜ï¼Œä¸çŸ¥é“å“ªé‡Œé”™äº†ã€‚æ€ä¹ˆè°ƒè¯•ï¼Ÿ

### ç­”æ¡ˆ

**è‰¯å¥½çš„è°ƒè¯•ä¹ æƒ¯èƒ½äº‹åŠåŠŸå€ï¼**

```python
def debugging_tips():
    """
    è°ƒè¯•æŠ€å·§
    """
    print("ğŸ› è°ƒè¯•æŠ€å·§:")
    
    # 1. æ‰“å°æ—¥å¿—
    print("\n[1/5] è¯¦ç»†æ—¥å¿—")
    print("   è®°å½•å…³é”®æ­¥éª¤å’Œæ•°æ®")
    
    # 2. æ–­ç‚¹è°ƒè¯•
    print("\n[2/5] æ–­ç‚¹è°ƒè¯•")
    print("   é€æ­¥æ‰§è¡Œï¼ŒæŸ¥çœ‹å˜é‡")
    
    # 3. å•å…ƒæµ‹è¯•
    print("\n[3/5] å•å…ƒæµ‹è¯•")
    print("   é€ä¸ªæ¨¡å—æµ‹è¯•ï¼Œå®šä½é—®é¢˜")
    
    # 4. æ•°æ®å¯è§†åŒ–
    print("\n[4/5] æ•°æ®å¯è§†åŒ–")
    print("   ç›´è§‚æŸ¥çœ‹æ•°æ®åˆ†å¸ƒ")
    
    # 5. æ€§èƒ½åˆ†æ
    print("\n[5/5] æ€§èƒ½åˆ†æ")
    print("   æ‰¾åˆ°æ€§èƒ½ç“¶é¢ˆ")

# ç¤ºä¾‹ï¼šå¸¦è°ƒè¯•ä¿¡æ¯çš„å‡½æ•°
def train_model_with_debug(X, y, debug=False):
    """å¸¦è°ƒè¯•ä¿¡æ¯çš„è®­ç»ƒå‡½æ•°"""
    if debug:
        print(f"\nğŸ” è°ƒè¯•ä¿¡æ¯:")
        print(f"  è¾“å…¥å½¢çŠ¶: X={X.shape}, y={y.shape}")
        print(f"  Xå‰5è¡Œ:\n{X.head()}")
        print(f"  yå‰5ä¸ª: {y[:5].values}")
    
    # è®­ç»ƒå‰æ£€æŸ¥
    assert not X.isna().any().any(), "XåŒ…å«ç¼ºå¤±å€¼"
    assert not y.isna().any(), "yåŒ…å«ç¼ºå¤±å€¼"
    assert len(X) == len(y), "Xå’Œyé•¿åº¦ä¸ä¸€è‡´"
    
    if debug:
        print(f"  âœ… æ•°æ®æ£€æŸ¥é€šè¿‡")
    
    # è®­ç»ƒæ¨¡å‹
    model = fit_model(X, y)
    
    if debug:
        print(f"  âœ… æ¨¡å‹è®­ç»ƒå®Œæˆ")
        print(f"  æ¨¡å‹å‚æ•°: {model.get_params()}")
    
    return model
```

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### é—®é¢˜

ç³»ç»Ÿè¿è¡Œæ…¢ï¼Œæ€ä¹ˆä¼˜åŒ–ï¼Ÿ

### ç­”æ¡ˆ

**æ€§èƒ½ä¼˜åŒ–æ˜¯ç³»ç»Ÿå·¥ç¨‹ï¼**

```python
def performance_optimization():
    """
    æ€§èƒ½ä¼˜åŒ–
    """
    print("âš¡ æ€§èƒ½ä¼˜åŒ–:")
    
    # 1. å‘é‡åŒ–
    print("\n[1/5] å‘é‡åŒ–æ“ä½œ")
    print("   é¿å…forå¾ªç¯ï¼Œä½¿ç”¨å‘é‡åŒ–")
    
    # 2. å¹¶è¡ŒåŒ–
    print("\n[2/5] å¹¶è¡Œè®¡ç®—")
    print("   åˆ©ç”¨å¤šæ ¸CPU")
    
    # 3. ç¼“å­˜
    print("\n[3/5] ç¼“å­˜æœºåˆ¶")
    print("   ç¼“å­˜é‡å¤è®¡ç®—çš„ç»“æœ")
    
    # 4. ç®—æ³•ä¼˜åŒ–
    print("\n[4/5] ç®—æ³•ä¼˜åŒ–")
    print("   é€‰æ‹©æ›´é«˜æ•ˆçš„ç®—æ³•")
    
    # 5. æ•°æ®ç»“æ„ä¼˜åŒ–
    print("\n[5/5] æ•°æ®ç»“æ„ä¼˜åŒ–")
    print("   é€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„")

# ç¤ºä¾‹ï¼šæ€§èƒ½å¯¹æ¯”
def benchmark_operations():
    """æ€§èƒ½åŸºå‡†æµ‹è¯•"""
    import time
    
    # ç”Ÿæˆæ•°æ®
    data = np.random.randn(1000000)
    
    # æµ‹è¯•1ï¼šforå¾ªç¯
    start = time.time()
    result_for = []
    for x in data:
        result_for.append(x * 2 + 1)
    time_for = time.time() - start
    
    # æµ‹è¯•2ï¼šå‘é‡åŒ–
    start = time.time()
    result_vec = data * 2 + 1
    time_vec = time.time() - start
    
    print(f"\nâš¡ æ€§èƒ½å¯¹æ¯”:")
    print(f"  forå¾ªç¯: {time_for:.4f}ç§’")
    print(f"  å‘é‡åŒ–: {time_vec:.4f}ç§’")
    print(f"  åŠ é€Ÿæ¯”: {time_for/time_vec:.1f}x")
```

---

## ğŸ“ æœ¬èŠ‚å°ç»“

**æ ¸å¿ƒè¦ç‚¹**ï¼š

1. âœ… é‡è®­ç»ƒé¢‘ç‡æ ¹æ®å¸‚åœºã€ç­–ç•¥ã€ICç»¼åˆå†³å®š
2. âœ… é£é™©ä¸æ”¶ç›Šè¦å¹³è¡¡ï¼Œæ´»ç€æ¯”èµšé’±é‡è¦
3. âœ… é›†æˆæ–¹æ³•æ ¹æ®é—®é¢˜ç±»å‹å’Œæ•°æ®ç‰¹ç‚¹é€‰æ‹©
4. âœ… é˜²æ­¢è¿‡æ‹Ÿåˆæ˜¯æ°¸æ’çš„ä¸»é¢˜
5. âœ… é«˜å¯ç”¨æ€§éœ€è¦å†—ä½™ã€ç›‘æ§ã€æ¢å¤

**é¿å‘äº”åŸåˆ™**ï¼š

```python
avoid_pitfalls = {
    "åŸåˆ™1": "ä¸è¦ç›¸ä¿¡å•ä¸€æŒ‡æ ‡",
    "åŸåˆ™2": "ä¸è¦å¿½ç•¥é£é™©ç®¡ç†",
    "åŸåˆ™3": "ä¸è¦è¿‡åº¦æ‹Ÿåˆ",
    "åŸåˆ™4": "ä¸è¦åœæ­¢å­¦ä¹ ",
    "åŸåˆ™5": "ä¸è¦ç›²ç›®è·Ÿé£"
}
```

**ä¸‹ä¸€æ­¥**ï¼šå­¦ä¹ äº†å¸¸è§é—®é¢˜ï¼Œæ¥çœ‹çœ‹**å®æˆ˜æ¡ˆä¾‹**å§ï¼

[â†’ å‰å¾€ 10-å®æˆ˜æ¡ˆä¾‹](10-å®æˆ˜æ¡ˆä¾‹.md)

---

**â“ é¿å‘æ˜¯æˆé•¿çš„å…³é”®ï¼Œä¸‹èŠ‚è¯¾çœ‹å®æˆ˜æ¡ˆä¾‹ï¼Œç†è®ºè”ç³»å®é™…ï¼**
