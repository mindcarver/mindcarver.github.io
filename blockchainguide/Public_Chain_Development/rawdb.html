<!DOCTYPE html>
<html lang="zh" dir="ltr"><head><title>rawdb</title><meta charset="utf-8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto Serif SC:wght@400;700&amp;family=Noto Sans SC:ital,wght@0,400;0,600;1,400;1,600&amp;family=JetBrains Mono:wght@400;600&amp;display=swap"/><link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin="anonymous"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="og:site_name" content="量化投资技术文档"/><meta property="og:title" content="rawdb"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="rawdb"/><meta name="twitter:description" content="accessors_chain.go是go-ethereum/core/rawdb模块的一个文件，在v1.10.18版本中用于实现访问区块链数据的函数。以下是对该文件的详细分析： accessors_chain.go文件定义了一系列函数，用于访问和获取区块链数据。这些函数大部分都是通过调用rawdb.go中的函数实现的，主要有以下几个函数： GetBlockByHash：通过区块的哈希值获取对应的区块数据。 GetBlockByNumber：通过区块的高度获取对应的区块数据。 GetBlockHashesFromHash：获取从起始区块哈希值到结束区块哈希值之间所有区块的哈希值。 GetBlo..."/><meta property="og:description" content="accessors_chain.go是go-ethereum/core/rawdb模块的一个文件，在v1.10.18版本中用于实现访问区块链数据的函数。以下是对该文件的详细分析： accessors_chain.go文件定义了一系列函数，用于访问和获取区块链数据。这些函数大部分都是通过调用rawdb.go中的函数实现的，主要有以下几个函数： GetBlockByHash：通过区块的哈希值获取对应的区块数据。 GetBlockByNumber：通过区块的高度获取对应的区块数据。 GetBlockHashesFromHash：获取从起始区块哈希值到结束区块哈希值之间所有区块的哈希值。 GetBlo..."/><meta property="og:image:alt" content="accessors_chain.go是go-ethereum/core/rawdb模块的一个文件，在v1.10.18版本中用于实现访问区块链数据的函数。以下是对该文件的详细分析： accessors_chain.go文件定义了一系列函数，用于访问和获取区块链数据。这些函数大部分都是通过调用rawdb.go中的函数实现的，主要有以下几个函数： GetBlockByHash：通过区块的哈希值获取对应的区块数据。 GetBlockByNumber：通过区块的高度获取对应的区块数据。 GetBlockHashesFromHash：获取从起始区块哈希值到结束区块哈希值之间所有区块的哈希值。 GetBlo..."/><meta property="og:image" content="https://https://mindcarver.top/static/og-image.png"/><meta property="og:image:url" content="https://https://mindcarver.top/static/og-image.png"/><meta name="twitter:image" content="https://https://mindcarver.top/static/og-image.png"/><meta property="og:image:type" content="image/.png"/><meta property="twitter:domain" content="https://mindcarver.top"/><meta property="og:url" content="https://https//mindcarver.top/blockchainguide/Public_Chain_Development/rawdb"/><meta property="twitter:url" content="https://https//mindcarver.top/blockchainguide/Public_Chain_Development/rawdb"/><link rel="icon" href="../../static/icon.png"/><meta name="description" content="accessors_chain.go是go-ethereum/core/rawdb模块的一个文件，在v1.10.18版本中用于实现访问区块链数据的函数。以下是对该文件的详细分析： accessors_chain.go文件定义了一系列函数，用于访问和获取区块链数据。这些函数大部分都是通过调用rawdb.go中的函数实现的，主要有以下几个函数： GetBlockByHash：通过区块的哈希值获取对应的区块数据。 GetBlockByNumber：通过区块的高度获取对应的区块数据。 GetBlockHashesFromHash：获取从起始区块哈希值到结束区块哈希值之间所有区块的哈希值。 GetBlo..."/><meta name="generator" content="Quartz"/><link href="../../index.css" rel="stylesheet" type="text/css" data-persist="true"/><style>.expand-button {
  position: absolute;
  display: flex;
  float: right;
  padding: 0.4rem;
  margin: 0.3rem;
  right: 0;
  color: var(--gray);
  border-color: var(--dark);
  background-color: var(--light);
  border: 1px solid;
  border-radius: 5px;
  opacity: 0;
  transition: 0.2s;
}
.expand-button > svg {
  fill: var(--light);
  filter: contrast(0.3);
}
.expand-button:hover {
  cursor: pointer;
  border-color: var(--secondary);
}
.expand-button:focus {
  outline: 0;
}

pre:hover > .expand-button {
  opacity: 1;
  transition: 0.2s;
}

#mermaid-container {
  position: fixed;
  contain: layout;
  z-index: 999;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  display: none;
  backdrop-filter: blur(4px);
  background: rgba(0, 0, 0, 0.5);
}
#mermaid-container.active {
  display: inline-block;
}
#mermaid-container > #mermaid-space {
  border: 1px solid var(--lightgray);
  background-color: var(--light);
  border-radius: 5px;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  height: 80vh;
  width: 80vw;
  overflow: hidden;
}
#mermaid-container > #mermaid-space > .mermaid-content {
  position: relative;
  transform-origin: 0 0;
  transition: transform 0.1s ease;
  overflow: visible;
  min-height: 200px;
  min-width: 200px;
}
#mermaid-container > #mermaid-space > .mermaid-content pre {
  margin: 0;
  border: none;
}
#mermaid-container > #mermaid-space > .mermaid-content svg {
  max-width: none;
  height: auto;
}
#mermaid-container > #mermaid-space > .mermaid-controls {
  position: absolute;
  bottom: 20px;
  right: 20px;
  display: flex;
  gap: 8px;
  padding: 8px;
  background: var(--light);
  border: 1px solid var(--lightgray);
  border-radius: 6px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  z-index: 2;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  padding: 0;
  border: 1px solid var(--lightgray);
  background: var(--light);
  color: var(--dark);
  border-radius: 4px;
  cursor: pointer;
  font-size: 16px;
  font-family: var(--bodyFont);
  transition: all 0.2s ease;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:hover {
  background: var(--lightgray);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:active {
  transform: translateY(1px);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:nth-child(2) {
  width: auto;
  padding: 0 12px;
  font-size: 14px;
}
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VSb290IjoiL2hvbWUvcnVubmVyL3dvcmsvbWluZGNhcnZlci5naXRodWIuaW8vbWluZGNhcnZlci5naXRodWIuaW8vcXVhcnR6L2NvbXBvbmVudHMvc3R5bGVzIiwic291cmNlcyI6WyJtZXJtYWlkLmlubGluZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTtFQUNBOztBQUdGO0VBQ0U7RUFDQTs7QUFHRjtFQUNFOzs7QUFLRjtFQUNFO0VBQ0E7OztBQUlKO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTs7QUFFQTtFQUNFOztBQUdGO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTtFQUNBOztBQUdGO0VBQ0U7RUFDQTs7QUFJSjtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7O0FBR0Y7RUFDRTs7QUFJRjtFQUNFO0VBQ0E7RUFDQSIsInNvdXJjZXNDb250ZW50IjpbIi5leHBhbmQtYnV0dG9uIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICBkaXNwbGF5OiBmbGV4O1xuICBmbG9hdDogcmlnaHQ7XG4gIHBhZGRpbmc6IDAuNHJlbTtcbiAgbWFyZ2luOiAwLjNyZW07XG4gIHJpZ2h0OiAwOyAvLyBOT1RFOiByaWdodCB3aWxsIGJlIHNldCBpbiBtZXJtYWlkLmlubGluZS50c1xuICBjb2xvcjogdmFyKC0tZ3JheSk7XG4gIGJvcmRlci1jb2xvcjogdmFyKC0tZGFyayk7XG4gIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWxpZ2h0KTtcbiAgYm9yZGVyOiAxcHggc29saWQ7XG4gIGJvcmRlci1yYWRpdXM6IDVweDtcbiAgb3BhY2l0eTogMDtcbiAgdHJhbnNpdGlvbjogMC4ycztcblxuICAmID4gc3ZnIHtcbiAgICBmaWxsOiB2YXIoLS1saWdodCk7XG4gICAgZmlsdGVyOiBjb250cmFzdCgwLjMpO1xuICB9XG5cbiAgJjpob3ZlciB7XG4gICAgY3Vyc29yOiBwb2ludGVyO1xuICAgIGJvcmRlci1jb2xvcjogdmFyKC0tc2Vjb25kYXJ5KTtcbiAgfVxuXG4gICY6Zm9jdXMge1xuICAgIG91dGxpbmU6IDA7XG4gIH1cbn1cblxucHJlIHtcbiAgJjpob3ZlciA+IC5leHBhbmQtYnV0dG9uIHtcbiAgICBvcGFjaXR5OiAxO1xuICAgIHRyYW5zaXRpb246IDAuMnM7XG4gIH1cbn1cblxuI21lcm1haWQtY29udGFpbmVyIHtcbiAgcG9zaXRpb246IGZpeGVkO1xuICBjb250YWluOiBsYXlvdXQ7XG4gIHotaW5kZXg6IDk5OTtcbiAgbGVmdDogMDtcbiAgdG9wOiAwO1xuICB3aWR0aDogMTAwdnc7XG4gIGhlaWdodDogMTAwdmg7XG4gIG92ZXJmbG93OiBoaWRkZW47XG4gIGRpc3BsYXk6IG5vbmU7XG4gIGJhY2tkcm9wLWZpbHRlcjogYmx1cig0cHgpO1xuICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuNSk7XG5cbiAgJi5hY3RpdmUge1xuICAgIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgfVxuXG4gICYgPiAjbWVybWFpZC1zcGFjZSB7XG4gICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tbGlnaHRncmF5KTtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1saWdodCk7XG4gICAgYm9yZGVyLXJhZGl1czogNXB4O1xuICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICB0b3A6IDUwJTtcbiAgICBsZWZ0OiA1MCU7XG4gICAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwgLTUwJSk7XG4gICAgaGVpZ2h0OiA4MHZoO1xuICAgIHdpZHRoOiA4MHZ3O1xuICAgIG92ZXJmbG93OiBoaWRkZW47XG5cbiAgICAmID4gLm1lcm1haWQtY29udGVudCB7XG4gICAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gICAgICB0cmFuc2Zvcm0tb3JpZ2luOiAwIDA7XG4gICAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4xcyBlYXNlO1xuICAgICAgb3ZlcmZsb3c6IHZpc2libGU7XG4gICAgICBtaW4taGVpZ2h0OiAyMDBweDtcbiAgICAgIG1pbi13aWR0aDogMjAwcHg7XG5cbiAgICAgIHByZSB7XG4gICAgICAgIG1hcmdpbjogMDtcbiAgICAgICAgYm9yZGVyOiBub25lO1xuICAgICAgfVxuXG4gICAgICBzdmcge1xuICAgICAgICBtYXgtd2lkdGg6IG5vbmU7XG4gICAgICAgIGhlaWdodDogYXV0bztcbiAgICAgIH1cbiAgICB9XG5cbiAgICAmID4gLm1lcm1haWQtY29udHJvbHMge1xuICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgYm90dG9tOiAyMHB4O1xuICAgICAgcmlnaHQ6IDIwcHg7XG4gICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgZ2FwOiA4cHg7XG4gICAgICBwYWRkaW5nOiA4cHg7XG4gICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1saWdodCk7XG4gICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1saWdodGdyYXkpO1xuICAgICAgYm9yZGVyLXJhZGl1czogNnB4O1xuICAgICAgYm94LXNoYWRvdzogMCAycHggNHB4IHJnYmEoMCwgMCwgMCwgMC4xKTtcbiAgICAgIHotaW5kZXg6IDI7XG5cbiAgICAgIC5tZXJtYWlkLWNvbnRyb2wtYnV0dG9uIHtcbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgICAgIHdpZHRoOiAzMnB4O1xuICAgICAgICBoZWlnaHQ6IDMycHg7XG4gICAgICAgIHBhZGRpbmc6IDA7XG4gICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWxpZ2h0Z3JheSk7XG4gICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWxpZ2h0KTtcbiAgICAgICAgY29sb3I6IHZhcigtLWRhcmspO1xuICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7XG4gICAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICAgICAgZm9udC1zaXplOiAxNnB4O1xuICAgICAgICBmb250LWZhbWlseTogdmFyKC0tYm9keUZvbnQpO1xuICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlO1xuXG4gICAgICAgICY6aG92ZXIge1xuICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWxpZ2h0Z3JheSk7XG4gICAgICAgIH1cblxuICAgICAgICAmOmFjdGl2ZSB7XG4gICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDFweCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTdHlsZSB0aGUgcmVzZXQgYnV0dG9uIGRpZmZlcmVudGx5XG4gICAgICAgICY6bnRoLWNoaWxkKDIpIHtcbiAgICAgICAgICB3aWR0aDogYXV0bztcbiAgICAgICAgICBwYWRkaW5nOiAwIDEycHg7XG4gICAgICAgICAgZm9udC1zaXplOiAxNHB4O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59XG4iXX0= */</style><link href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" rel="stylesheet" type="text/css" data-persist="true"/><script src="../../prescript.js" type="application/javascript" data-persist="true"></script><script type="application/javascript" data-persist="true">const fetchData = fetch("../../static/contentIndex.json").then(data => data.json())</script><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://https://mindcarver.top/index.xml"/></head><body data-slug="blockchainguide/Public_Chain_Development/rawdb"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h2 class="page-title"><a href="../..">量化投资技术文档</a></h2><div class="spacer mobile-only"></div><div class="flex-component" style="flex-direction: row; flex-wrap: nowrap; gap: 1rem;"><div style="flex-grow: 1; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><div class="search"><button class="search-button"><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title>Search</title><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg><p>搜索</p></button><div class="search-container"><div class="search-space"><input autocomplete="off" class="search-bar" name="search" type="text" aria-label="搜索些什么" placeholder="搜索些什么"/><div class="search-layout" data-preview="true"></div></div></div></div></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="darkmode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve" aria-label="暗色模式"><title>暗色模式</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve" aria-label="亮色模式"><title>亮色模式</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></button></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="readermode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="readerIcon" fill="currentColor" stroke="currentColor" stroke-width="0.2" stroke-linecap="round" stroke-linejoin="round" width="64px" height="64px" viewBox="0 0 24 24" aria-label="阅读模式"><title>阅读模式</title><g transform="translate(-1.8, -1.8) scale(1.15, 1.2)"><path d="M8.9891247,2.5 C10.1384702,2.5 11.2209868,2.96705384 12.0049645,3.76669482 C12.7883914,2.96705384 13.8709081,2.5 15.0202536,2.5 L18.7549359,2.5 C19.1691495,2.5 19.5049359,2.83578644 19.5049359,3.25 L19.5046891,4.004 L21.2546891,4.00457396 C21.6343849,4.00457396 21.9481801,4.28672784 21.9978425,4.6528034 L22.0046891,4.75457396 L22.0046891,20.25 C22.0046891,20.6296958 21.7225353,20.943491 21.3564597,20.9931534 L21.2546891,21 L2.75468914,21 C2.37499337,21 2.06119817,20.7178461 2.01153575,20.3517706 L2.00468914,20.25 L2.00468914,4.75457396 C2.00468914,4.37487819 2.28684302,4.061083 2.65291858,4.01142057 L2.75468914,4.00457396 L4.50368914,4.004 L4.50444233,3.25 C4.50444233,2.87030423 4.78659621,2.55650904 5.15267177,2.50684662 L5.25444233,2.5 L8.9891247,2.5 Z M4.50368914,5.504 L3.50468914,5.504 L3.50468914,19.5 L10.9478955,19.4998273 C10.4513189,18.9207296 9.73864328,18.5588115 8.96709342,18.5065584 L8.77307039,18.5 L5.25444233,18.5 C4.87474657,18.5 4.56095137,18.2178461 4.51128895,17.8517706 L4.50444233,17.75 L4.50368914,5.504 Z M19.5049359,17.75 C19.5049359,18.1642136 19.1691495,18.5 18.7549359,18.5 L15.2363079,18.5 C14.3910149,18.5 13.5994408,18.8724714 13.0614828,19.4998273 L20.5046891,19.5 L20.5046891,5.504 L19.5046891,5.504 L19.5049359,17.75 Z M18.0059359,3.999 L15.0202536,4 L14.8259077,4.00692283 C13.9889509,4.06666544 13.2254227,4.50975805 12.7549359,5.212 L12.7549359,17.777 L12.7782651,17.7601316 C13.4923805,17.2719483 14.3447024,17 15.2363079,17 L18.0059359,16.999 L18.0056891,4.798 L18.0033792,4.75457396 L18.0056891,4.71 L18.0059359,3.999 Z M8.9891247,4 L6.00368914,3.999 L6.00599909,4.75457396 L6.00599909,4.75457396 L6.00368914,4.783 L6.00368914,16.999 L8.77307039,17 C9.57551536,17 10.3461406,17.2202781 11.0128313,17.6202194 L11.2536891,17.776 L11.2536891,5.211 C10.8200889,4.56369974 10.1361548,4.13636104 9.37521067,4.02745763 L9.18347055,4.00692283 L8.9891247,4 Z"></path></g></svg></button></div></div><div class="explorer" data-behavior="link" data-collapsed="collapsed" data-savestate="true" data-data-fns="{&quot;order&quot;:[&quot;filter&quot;,&quot;map&quot;,&quot;sort&quot;],&quot;sortFn&quot;:&quot;(a,b)=>!a.isFolder&amp;&amp;!b.isFolder||a.isFolder&amp;&amp;b.isFolder?a.displayName.localeCompare(b.displayName,void 0,{numeric:!0,sensitivity:\&quot;base\&quot;}):!a.isFolder&amp;&amp;b.isFolder?1:-1&quot;,&quot;filterFn&quot;:&quot;node=>node.slugSegment!==\&quot;tags\&quot;&quot;,&quot;mapFn&quot;:&quot;node=>node&quot;}"><button type="button" class="explorer-toggle mobile-explorer hide-until-loaded" data-mobile="true" aria-controls="explorer-431"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-menu"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button><button type="button" class="title-button explorer-toggle desktop-explorer" data-mobile="false" aria-expanded="true"><h2>探索</h2><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="explorer-431" class="explorer-content" aria-expanded="false" role="group"><ul class="explorer-ul overflow" id="list-0"><li class="overflow-end"></li></ul></div><template id="template-file"><li><a href="#"></a></li></template><template id="template-folder"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div><button class="folder-button"><span class="folder-title"></span></button></div></div><div class="folder-outer"><ul class="content"></ul></div></li></template></div></div><div class="center"><div class="page-header"><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="../../">Home</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../blockchainguide/">区块链技术指南</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../blockchainguide/Public_Chain_Development/">Public_Chain_Development</a><p> ❯ </p></div><div class="breadcrumb-element"><a href>rawdb</a></div></nav><h1 class="article-title">rawdb</h1><p show-comma="true" class="content-meta"><time datetime="2026-01-12T10:57:07.460Z">2026年1月12日</time><span>17分钟阅读</span></p><ul class="tags"><li><a href="../../tags/TODO" class="internal tag-link">TODO</a></li></ul></div></div><article class="popover-hint"><p>accessors_chain.go是go-ethereum/core/rawdb模块的一个文件，在v1.10.18版本中用于实现访问区块链数据的函数。以下是对该文件的详细分析：</p>
<p>accessors_chain.go文件定义了一系列函数，用于访问和获取区块链数据。这些函数大部分都是通过调用rawdb.go中的函数实现的，主要有以下几个函数：</p>
<ol>
<li>GetBlockByHash：通过区块的哈希值获取对应的区块数据。</li>
<li>GetBlockByNumber：通过区块的高度获取对应的区块数据。</li>
<li>GetBlockHashesFromHash：获取从起始区块哈希值到结束区块哈希值之间所有区块的哈希值。</li>
<li>GetBlockHeaderByHash：通过区块的哈希值获取对应的区块头数据。</li>
<li>GetBlockHeaderByNumber：通过区块的高度获取对应的区块头数据。</li>
<li>GetCanonicalHash：获取指定高度的主链区块哈希值。</li>
<li>GetCanonicalHashes：获取指定高度范围内的主链区块哈希值。</li>
<li>GetHeaderByHash：通过区块的哈希值获取对应的区块头数据。</li>
<li>GetHeaderByNumber：通过区块的高度获取对应的区块头数据。</li>
<li>GetTd：获取指定区块哈希值的总难度。</li>
</ol>
<p>这些函数的实现主要都是通过调用rawdb.go中的GetBlock、GetBlockHeader等函数实现的。其中，GetBlockByHash和GetBlockByNumber函数用于获取指定区块哈希值或高度的区块数据；GetBlockHeaderByHash和GetBlockHeaderByNumber函数用于获取指定区块哈希值或高度的区块头数据；GetCanonicalHash和GetCanonicalHashes函数用于获取指定高度的主链区块哈希值或者指定高度范围内的主链区块哈希值；GetHeaderByHash和GetHeaderByNumber函数用于获取指定区块哈希值或高度的区块头数据；GetTd函数用于获取指定区块哈希值的总难度。</p>
<p>除了上述函数外，accessors_chain.go文件还定义了一些辅助函数，如GetBlockByNumberOrHash、GetBlockHashes、GetHeader、GetTdByHash等。这些函数主要是为了方便访问和获取区块链数据而设计的。</p>
<p>总的来说，accessors_chain.go文件为其他模块提供了访问和获取区块链数据的接口，它们是以太坊系统的核心组件之一。这些函数的实现依赖于rawdb.go中提供的访问数据库的函数和数据存储结构，因此需要保证这些函数的正确性和可靠性，以确保整个以太坊系统的稳定运行。</p>
<p>需要注意的是，访问和获取区块链数据的效率是非常重要的。区块链数据的体量庞大，如果访问和获取数据的速度过慢，将会严重影响整个系统的性能。因此，在实现这些函数时需要考虑到效率和性能的问题。例如，在获取区块数据时，可以通过缓存、批量读取等方式来提高读取速度；在获取主链区块哈希值时，可以通过利用区块链的高度和哈希值的对应关系来加速查询。</p>
<p>除了效率和性能问题外，还需要考虑到数据一致性和可靠性的问题。区块链数据的正确性对整个系统的稳定运行至关重要，因此在访问和获取数据时需要保证数据的一致性和可靠性。例如，在获取区块数据时，需要确保读取的数据是正确的、完整的，并且数据的顺序是正确的。</p>
<p>总的来说，accessors_chain.go文件的实现需要兼顾效率、性能、一致性和可靠性等多个方面的要求，这是保证整个以太坊系统稳定运行的重要保障。</p>
<h2 id="ancient数据库">ancient数据库<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ancient数据库" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>freezerdb 是以太坊的冻结数据库，它使用了两个子数据库：AncientStore 和 KeyValueStore</p>
<p>Freeze方法指定阈值90000个块，就会把区块塞到冷冻库</p>
<p>freezer 数据库是以太坊的一个优化功能，用于将旧的、不再需要访问的区块数据从 key-value 数据库中移除，并将其存储到独立的 freezer 数据库中。这些旧的区块在以太坊同步过程中不会被访问，但是在需要重新构建区块链状态时，这些旧的区块数据仍然非常重要。使用 freezer 数据库可以减少 key-value 数据库的大小，提高同步和查询性能，并且可以消除因 key-value 数据库大小过大而导致的同步失败问题。所以keyvalue数据库要和freeze数据库的数据能连起来。</p>
<p><code>freezer_table.go</code> 是 Geth 中实现冷数据存储的一个重要文件，用于实现以太坊的冷数据存储机制。以下是对 <code>freezer_table.go</code> 的实现细节进行详细分析：</p>
<ol>
<li>数据结构</li>
</ol>
<p><code>freezer_table.go</code> 中定义了两个重要的数据结构：<code>FreezerTable</code> 和 <code>FreezerChunkStore</code>。</p>
<p><code>FreezerTable</code> 是一个结构体，表示一个冷数据表。它包含了一个键值数据库句柄、数据表起始块号、每个冷数据块的大小、以及一个元数据缓存。元数据缓存用于缓存冷数据块的元数据，包括起始块号、结束块号、块的哈希值等信息。</p>
<p><code>FreezerChunkStore</code> 是一个结构体，表示一个冷数据块存储器。它包含了一个键值数据库句柄、数据块的哈希值以及块的长度。它还包含了一个 <code>FreezerTable</code> 指针，用于表示该块所属的冷数据表。</p>
<ol>
<li>冷数据表初始化</li>
</ol>
<p>在 <code>freezer_table.go</code> 中，冷数据表的初始化是通过 <code>NewFreezerTable</code> 函数实现的。该函数接收一个键值数据库句柄、起始块号、冷数据块大小等参数，并返回一个 <code>FreezerTable</code> 对象。</p>
<p>在初始化过程中，<code>NewFreezerTable</code> 函数会使用传入的键值数据库句柄创建一个名为 <code>freezer-metadata</code> 的命名空间，并将冷数据表的元数据存储在其中。然后，它会使用传入的起始块号和冷数据块大小计算每个冷数据块的起始块号和结束块号，并将这些元数据存储在元数据缓存中。</p>
<ol>
<li>冷数据的读写操作</li>
</ol>
<p>在 <code>freezer_table.go</code> 中，冷数据的读写操作是通过 <code>FreezerTable</code>结构体中的 <code>Get</code> 和 <code>Put</code> 方法实现的。</p>
<p><code>Get</code> 方法接收一个块号作为参数，并返回对应的冷数据块。具体实现过程如下：</p>
<p>首先，<code>Get</code> 方法会检查元数据缓存中是否有该块的元数据。如果有，它会使用元数据中的起始块号和结束块号计算出该块在数据库中的键名，并使用键值数据库句柄获取该键对应的数据块。</p>
<p>如果元数据缓存中没有该块的元数据，则会使用该块号和冷数据块大小计算出该块在数据库中的键名，并使用键值数据库句柄获取该键对应的数据块。此时，如果获取到了数据块，<code>Get</code> 方法会将该块的元数据存储到元数据缓存中。</p>
<p><code>Put</code> 方法接收一个块号和一个冷数据块作为参数，并将该冷数据块存储到对应的冷数据块存储器中。具体实现过程如下：</p>
<p>首先，<code>Put</code> 方法会使用传入的块号计算出该块在数据库中的键名，并将该块存储到键值数据库句柄中。然后，它会将该块的元数据存储到元数据缓存中。</p>
<ol>
<li>冷数据块的哈希值计算</li>
</ol>
<p>在 <code>freezer_table.go</code> 中，冷数据块的哈希值计算是通过 <code>FreezerChunkStore</code> 结构体的 <code>Hash</code> 方法实现的。</p>
<p><code>Hash</code> 方法会读取存储在键值数据库句柄中的冷数据块，并使用 Keccak-256 算法计算出该块的哈希值。计算出的哈希值会被存储到 <code>FreezerChunkStore</code> 结构体中，并在之后的冷数据块读写操作中使用。</p>
<p>通过以上分析，我们可以了解到 Geth 中冷数据存储的实现原理和机制。冷数据表使用元数据缓存缓存冷数据块的元数据，以避免重复读取块的元数据。冷数据块存储器使用 Keccak-256 算法计算冷数据块的哈希值，并将哈希值存储到键值数据库中，以便在之后的读取操作中进行校验。在实际使用中，冷数据存储机制可以有效地减少以太坊节点的存储压力，提高节点的运行效率。</p>
<p><code>freezer.go</code> 是 Geth 中实现冷数据管理的一个重要文件，用于实现以太坊的冷数据存储和管理机制。以下是对 <code>freezer.go</code> 的实现细节进行详细分析：</p>
<ol>
<li>数据结构</li>
</ol>
<p><code>freezer.go</code> 中定义了两个重要的数据结构：<code>Freezer</code> 和 <code>FreezerWriter</code>。</p>
<p><code>Freezer</code> 是一个结构体，表示一个冷数据管理器。它包含了一个锁、一个键值数据库句柄、一个起始块号、一个冷数据块大小、以及一个冷数据表缓存。冷数据表缓存用于缓存冷数据表，以提高冷数据的读取效率。</p>
<p><code>FreezerWriter</code> 是一个结构体，表示一个冷数据写入器。它包含了一个 <code>Freezer</code> 指针和一个写入队列。写入队列用于缓存待写入的冷数据块，以便在后续的写入操作中进行批量写入。</p>
<ol>
<li>冷数据表的创建和获取</li>
</ol>
<p>在 <code>freezer.go</code> 中，冷数据表的创建和获取是通过 <code>Freezer</code> 结构体中的 <code>getTable</code> 方法实现的。</p>
<p><code>getTable</code> 方法接收一个块号作为参数，并返回对应的冷数据表。具体实现过程如下：</p>
<p>首先，<code>getTable</code> 方法会检查冷数据表缓存中是否有该块所属的冷数据表。如果有，它会直接返回该冷数据表。</p>
<p>如果冷数据表缓存中没有该冷数据表，则会使用传入的块号和冷数据块大小计算出该块所属的冷数据表的起始块号，并使用 <code>FreezerTable.NewFreezerTable</code> 函数创建一个新的冷数据表。然后，它会将该冷数据表存储到冷数据表缓存中，并返回该冷数据表。</p>
<ol>
<li>冷数据的读写操作</li>
</ol>
<p>在 <code>freezer.go</code>中，冷数据的读写操作是通过<code>Freezer</code>结构体中的<code>Read</code>和<code>Write</code> 方法实现的。</p>
<p><code>Read</code> 方法接收一个块号作为参数，并返回对应的冷数据块。具体实现过程如下：</p>
<p>首先，<code>Read</code> 方法会获取对应冷数据块所属的冷数据表。然后，它会调用冷数据表的 <code>Get</code> 方法获取对应的冷数据块。</p>
<p>如果获取到了冷数据块，则会返回该冷数据块。</p>
<p><code>Write</code> 方法接收一个块号和一个冷数据块作为参数，并将该冷数据块写入到对应的冷数据存储器中。具体实现过程如下：</p>
<p>首先，<code>Write</code> 方法会获取对应冷数据块所属的冷数据表。然后，它会将该冷数据块添加到冷数据写入器的写入队列中。</p>
<p>在冷数据写入器的后台协程中，会定期从写入队列中读取待写入的冷数据块，并将它们批量写入到对应的冷数据存储器中。写入操作会使用 <code>FreezerChunkStore.Put</code> 方法将冷数据块写入到键值数据库中，并使用 <code>FreezerTable.Put</code> 方法将冷数据块的元数据写入到冷数据表的元数据缓存中。</p>
<ol>
<li>冷数据的清理操作</li>
</ol>
<p>在 <code>freezer.go</code> 中，冷数据的清理操作是通过 <code>Freezer</code> 结构体中的 <code>Prune</code> 方法实现的。</p>
<p><code>Prune</code> 方法接收一个块号作为参数，并清除所有小于该块号的冷数据块。具体实现过程如下：</p>
<p>首先，<code>Prune</code> 方法会获取对应冷数据块所属的冷数据表，并使用冷数据表的 <code>Prune</code> 方法清除所有小于该块号的冷数据块。然后，它会从冷数据表缓存中移除该冷数据表，以释放缓存空间。</p>
<ol>
<li>冷数据的校验操作</li>
</ol>
<p>在 <code>freezer.go</code> 中，冷数据的校验操作是通过 <code>Freezer</code> 结构体中的 <code>Verify</code> 方法实现的。</p>
<p><code>Verify</code> 方法接收一个块号和一个块的哈希值作为参数，并校验该块的哈希值是否正确。具体实现过程如下：</p>
<p>首先，<code>Verify</code> 方法会获取对应冷数据块所属的冷数据表，并使用冷数据表的 <code>Get</code> 方法获取对应的冷数据块。然后，它会使用 Keccak-256 算法计算该冷数据块的哈希值，并将计算出的哈希值与传入的哈希值进行比较。</p>
<p>如果两个哈希值相等，则说明冷数据块的校验通过，<code>Verify</code> 方法会返回 <code>true</code>。否则，说明冷数据块的校验失败，<code>Verify</code> 方法会返回 <code>false</code>。</p>
<p>通过以上分析，我们可以了解到 Geth 中冷数据管理的实现原理和机制。冷数据管理器使用冷数据表缓存缓存冷数据表，以提高冷数据的读取效率。冷数据写入器使用批量写入的方式将冷数据块写入到冷数据存储器中，以提高写入效率。在实际使用中，冷数据管理机制可以有效地减少以太坊节点的存储压力，提高节点的运行效率。</p>
<p><a href="../.././../tags/TODO" class="tag-link internal alias" data-slug="tags/TODO">TODO</a></p>
<p>详细分析Ancient数据库</p></article><hr/><div class="page-footer"></div></div><div class="right sidebar"><div class="graph"><h3>关系图谱</h3><div class="graph-outer"><div class="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:false,&quot;enableRadial&quot;:false}"></div><button class="global-graph-icon" aria-label="Global Graph"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
                s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
                c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
                C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
                c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
                v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
                s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
                C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
                S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
                s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
                s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></button></div><div class="global-graph-outer"><div class="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.2,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:true,&quot;enableRadial&quot;:true}"></div></div></div></div><footer class><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v1.0.0</a> © 2026</p><ul><li><a href="https://github.com/jackyzha0/quartz">GitHub</a></li><li><a href="https://discord.gg/cRFFHYye7t">Discord Community</a></li></ul></footer></div></div></body><script type="application/javascript" data-persist="true">function n(){let t=this.parentElement;t.classList.toggle("is-collapsed");let e=t.getElementsByClassName("callout-content")[0];if(!e)return;let l=t.classList.contains("is-collapsed");e.style.gridTemplateRows=l?"0fr":"1fr"}function c(){let t=document.getElementsByClassName("callout is-collapsible");for(let e of t){let l=e.getElementsByClassName("callout-title")[0],s=e.getElementsByClassName("callout-content")[0];if(!l||!s)continue;l.addEventListener("click",n),window.addCleanup(()=>l.removeEventListener("click",n));let o=e.classList.contains("is-collapsed");s.style.gridTemplateRows=o?"0fr":"1fr"}}document.addEventListener("nav",c);
</script><script type="module" data-persist="true">function E(a,e){if(!a)return;function t(o){o.target===this&&(o.preventDefault(),o.stopPropagation(),e())}function n(o){o.key.startsWith("Esc")&&(o.preventDefault(),e())}a?.addEventListener("click",t),window.addCleanup(()=>a?.removeEventListener("click",t)),document.addEventListener("keydown",n),window.addCleanup(()=>document.removeEventListener("keydown",n))}function f(a){for(;a.firstChild;)a.removeChild(a.firstChild)}var m=class{constructor(e,t){this.container=e;this.content=t;this.setupEventListeners(),this.setupNavigationControls(),this.resetTransform()}isDragging=!1;startPan={x:0,y:0};currentPan={x:0,y:0};scale=1;MIN_SCALE=.5;MAX_SCALE=3;cleanups=[];setupEventListeners(){let e=this.onMouseDown.bind(this),t=this.onMouseMove.bind(this),n=this.onMouseUp.bind(this),o=this.onTouchStart.bind(this),r=this.onTouchMove.bind(this),i=this.onTouchEnd.bind(this),s=this.resetTransform.bind(this);this.container.addEventListener("mousedown",e),document.addEventListener("mousemove",t),document.addEventListener("mouseup",n),this.container.addEventListener("touchstart",o,{passive:!1}),document.addEventListener("touchmove",r,{passive:!1}),document.addEventListener("touchend",i),window.addEventListener("resize",s),this.cleanups.push(()=>this.container.removeEventListener("mousedown",e),()=>document.removeEventListener("mousemove",t),()=>document.removeEventListener("mouseup",n),()=>this.container.removeEventListener("touchstart",o),()=>document.removeEventListener("touchmove",r),()=>document.removeEventListener("touchend",i),()=>window.removeEventListener("resize",s))}cleanup(){for(let e of this.cleanups)e()}setupNavigationControls(){let e=document.createElement("div");e.className="mermaid-controls";let t=this.createButton("+",()=>this.zoom(.1)),n=this.createButton("-",()=>this.zoom(-.1)),o=this.createButton("Reset",()=>this.resetTransform());e.appendChild(n),e.appendChild(o),e.appendChild(t),this.container.appendChild(e)}createButton(e,t){let n=document.createElement("button");return n.textContent=e,n.className="mermaid-control-button",n.addEventListener("click",t),window.addCleanup(()=>n.removeEventListener("click",t)),n}onMouseDown(e){e.button===0&&(this.isDragging=!0,this.startPan={x:e.clientX-this.currentPan.x,y:e.clientY-this.currentPan.y},this.container.style.cursor="grabbing")}onMouseMove(e){this.isDragging&&(e.preventDefault(),this.currentPan={x:e.clientX-this.startPan.x,y:e.clientY-this.startPan.y},this.updateTransform())}onMouseUp(){this.isDragging=!1,this.container.style.cursor="grab"}onTouchStart(e){if(e.touches.length!==1)return;this.isDragging=!0;let t=e.touches[0];this.startPan={x:t.clientX-this.currentPan.x,y:t.clientY-this.currentPan.y}}onTouchMove(e){if(!this.isDragging||e.touches.length!==1)return;e.preventDefault();let t=e.touches[0];this.currentPan={x:t.clientX-this.startPan.x,y:t.clientY-this.startPan.y},this.updateTransform()}onTouchEnd(){this.isDragging=!1}zoom(e){let t=Math.min(Math.max(this.scale+e,this.MIN_SCALE),this.MAX_SCALE),n=this.content.getBoundingClientRect(),o=n.width/2,r=n.height/2,i=t-this.scale;this.currentPan.x-=o*i,this.currentPan.y-=r*i,this.scale=t,this.updateTransform()}updateTransform(){this.content.style.transform=`translate(${this.currentPan.x}px, ${this.currentPan.y}px) scale(${this.scale})`}resetTransform(){let t=this.content.querySelector("svg").getBoundingClientRect(),n=t.width/this.scale,o=t.height/this.scale;this.scale=1,this.currentPan={x:(this.container.clientWidth-n)/2,y:(this.container.clientHeight-o)/2},this.updateTransform()}},T=["--secondary","--tertiary","--gray","--light","--lightgray","--highlight","--dark","--darkgray","--codeFont"],y;document.addEventListener("nav",async()=>{let e=document.querySelector(".center").querySelectorAll("code.mermaid");if(e.length===0)return;y||=await import("https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.4.0/mermaid.esm.min.mjs");let t=y.default,n=new WeakMap;for(let r of e)n.set(r,r.innerText);async function o(){for(let s of e){s.removeAttribute("data-processed");let c=n.get(s);c&&(s.innerHTML=c)}let r=T.reduce((s,c)=>(s[c]=window.getComputedStyle(document.documentElement).getPropertyValue(c),s),{}),i=document.documentElement.getAttribute("saved-theme")==="dark";t.initialize({startOnLoad:!1,securityLevel:"loose",theme:i?"dark":"base",themeVariables:{fontFamily:r["--codeFont"],primaryColor:r["--light"],primaryTextColor:r["--darkgray"],primaryBorderColor:r["--tertiary"],lineColor:r["--darkgray"],secondaryColor:r["--secondary"],tertiaryColor:r["--tertiary"],clusterBkg:r["--light"],edgeLabelBackground:r["--highlight"]}}),await t.run({nodes:e})}await o(),document.addEventListener("themechange",o),window.addCleanup(()=>document.removeEventListener("themechange",o));for(let r=0;r<e.length;r++){let v=function(){let g=l.querySelector("#mermaid-space"),h=l.querySelector(".mermaid-content");if(!h)return;f(h);let w=i.querySelector("svg").cloneNode(!0);h.appendChild(w),l.classList.add("active"),g.style.cursor="grab",u=new m(g,h)},M=function(){l.classList.remove("active"),u?.cleanup(),u=null},i=e[r],s=i.parentElement,c=s.querySelector(".clipboard-button"),d=s.querySelector(".expand-button"),p=window.getComputedStyle(c),L=c.offsetWidth+parseFloat(p.marginLeft||"0")+parseFloat(p.marginRight||"0");d.style.right=`calc(${L}px + 0.3rem)`,s.prepend(d);let l=s.querySelector("#mermaid-container");if(!l)return;let u=null;d.addEventListener("click",v),E(l,M),window.addCleanup(()=>{u?.cleanup(),d.removeEventListener("click",v)})}});
</script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/copy-tex.min.js" type="application/javascript" data-persist="true"></script><script src="../../postscript.js" type="module" data-persist="true"></script></html>